# -*- coding: binary -*-

require 'msf/core/exploit/cmdstager'

module Msf

####
# Allows for staging cmd to arbitrary payloads through the CmdStagerPrintf.
#
# This stager uses a POSIX-conformant printf, that supports the interpretation
# of octal escapes, to drop an ELF with the payload embedded to disk.
####

module Exploit::CmdStagerPrintf

  include Msf::Exploit::CmdStager

  # Initializes a CmdStagerPrintf instance for the supplied payload
  #
  # @param exe [String] The payload embedded into an ELF
  # @return [Rex::Exploitation::CmdStagerPrintf] Stager instance
  def create_stager(exe)
    Rex::Exploitation::CmdStagerPrintf.new(exe)
  end
end

end
